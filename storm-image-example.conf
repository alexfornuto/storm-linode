# This a configuration to create a Storm linode disk image which can
# then be replicated for each node during cluster creation.

# Run as "storm-cluster-linode.sh create-image storm-image.conf api_env_production.conf".

# Specify an OS distribution ID or distribution label. All nodes of a cluster
# created based on this image will have this distribution.
# The list of distribution IDs and labels can be obtained by running
#		"LINODE_KEY=<key> LINODE_API_URL=<url> linode_api.py distributions"
DISTRIBUTION_FOR_IMAGE=124
# or alternatively the distribution label (case does not matter)
# DISTRIBUTION_FOR_IMAGE="Ubuntu 14.04 LTS"


# A label for the image, as displayed in "images.list".
LABEL_FOR_IMAGE="Storm 0.9.5 Ubuntu 14.04 LTS"

# Default kernel for image: 138 seems to be the constant kernel ID of whatever's the latest 64-bit kernel.
# This kernel is used for all nodes of a cluster created from this image.
KERNEL_FOR_IMAGE=138
# or alternatively the partial or full kernel label (case does not matter)
# KERNEL_FOR_IMAGE="Latest 64 bit" or KERNEL_FOR_IMAGE="3.18.5-x86_64"

# Specify the preferred datacenter disk image is created.
# This can be any datacenter, but cluster creation may be faster 
# if the image is created in the same datacenter where cluster will be
# created.
# Time taken for transferring files from local system is another factor.
DATACENTER_FOR_IMAGE=9
# or alternatively, specify the LOCATION or ABBR returned by avail.datacenters (case does not matter)
# DATACENTER_FOR_IMAGE="Newark, NJ, USA"
# DATACENTER_FOR_IMAGE="newark"

# **** REQUIRED *****
#
# Default root password for all nodes in cluster created from this image.
# It can be overridden in each cluster's config file.
IMAGE_ROOT_PASSWORD=

# **** REQUIRED *****
#
# Default root SSH public and private key file. All nodes in a cluster created from this
# image will have this SSH key as an authorized user.
# It can be overridden in each cluster's config file.
IMAGE_ROOT_SSH_PUBLIC_KEY=
IMAGE_ROOT_SSH_PRIVATE_KEY=


# **** OPTIONAL *****
#
# A username for administrative purposes. This username can be used by
# all sysadmins / devops / developers to ssh into any node created from
# this image.
# This should not be 'root' or IMAGE_SCRIPT_SSH_USER.
# If this is left empty, a user is not created.
IMAGE_ADMIN_USER=

# **** REQUIRED if IMAGE_ADMIN_USER is defined *****
#
# Password for IMAGE_ADMIN_USER. 
# This should not be empty. If it is, it's considered a validation error
# and image creation will not proceed.
# If IMAGE_ADMIN_USER is empty, this is not used.
IMAGE_ADMIN_PASSWORD=

# **** OPTIONAL, used only if IMAGE_ADMIN_USER is defined *****
#
# A file containing public keys of all users who are authorized to 
# ssh into nodes as IMAGE_ADMIN_USER.
# This file can contain multiple public keys, just like a "authorized_keys" file.
# All these keys will be appended to the image's "authorized_keys".
IMAGE_ADMIN_SSH_AUTHORIZED_KEYS=

# Size of disk image in MB (max 24000). ~5GB is good enough for most
# distributions, and allows enough leftover storage quota in every plan
# to create additional disks if required.
IMAGE_DISK_SIZE=5000



# Automated OS upgrade has been surprisingly troublesome. Problems like grub package upgrade requires
# user interaction to select a device because it detects a hard disk identifier change (possibly due to 
# all the cloning and snapshotting), but since it's a silent upgrade, it simply runs in an endless
# loop showing the same errors.
# Even a hack like explicitly running grub-install first before upgrading didn't solve it.
# Recommend not to use this until all problems are resolved.
UPGRADE_OS=no

INSTALL_STORM_DISTRIBUTION=./apache-storm-0.9.5.tar.gz

STORM_INSTALL_DIRECTORY=/opt

# By default, "template-storm.yaml" is copied into image directory as "template-storm.yaml"
# Admin can customize this yaml file before creating the image, or use any other
# storm.yaml of their choice.
STORM_YAML_TEMPLATE=./template-storm.yaml

STORM_USER=storm

# By default, "template-storm-supervisord.conf" is copied into image directory as "storm-supervisord.conf"
# Admin can customize it before creating the image, or use any other
# storm-supervisord.conf of their choice.
SUPERVISORD_TEMPLATE_CONF=./template-storm-supervisord.conf




